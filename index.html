<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enviar no WhatsApp</title>
<style>
    :root {
        --verde-whatsapp: #25D366;
        --verde-escuro: #128C7E;
        --fundo-claro: #ffffff;
        --texto-claro: #000000;
        --fundo-escuro: #1e1e1e;
        --texto-escuro: #ffffff;
    }
    body {
        font-family: Arial, sans-serif;
        background-color: var(--fundo-claro);
        color: var(--texto-claro);
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding: 20px;
        transition: background 0.3s, color 0.3s;
    }
    body.dark {
        background-color: var(--fundo-escuro);
        color: var(--texto-escuro);
    }
    .container {
        background: rgba(255,255,255,0.9);
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        width: 380px;
        transition: background 0.3s;
    }
    body.dark .container {
        background: rgba(34,34,34,0.9);
    }
    h2 {
        margin-bottom: 15px;
        text-align: center;
    }
    input, textarea {
        width: 100%;
        padding: 10px;
        margin: 8px 0;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 14px;
        outline: none;
        transition: border 0.3s;
    }
    input:focus, textarea:focus {
        border-color: var(--verde-whatsapp);
    }
    button {
        padding: 6px 10px;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
        margin: 2px;
    }
    .btn-enviar {
        width: 100%;
        padding: 12px;
        font-weight: bold;
        background: var(--verde-whatsapp);
        color: white;
    }
    .btn-enviar:hover {
        background: var(--verde-escuro);
    }
    .btn-editar { background: orange; color: white; }
    .btn-excluir { background: red; color: white; }
    .btn-nota { background: #555; color: white; }
    .btn-nome { background: #007BFF; color: white; }
    .btn-reenviar { background: #4CAF50; color: white; }
    .tema-toggle {
        background: none;
        border: none;
        cursor: pointer;
        margin-bottom: 15px;
        font-size: 14px;
        color: var(--verde-whatsapp);
        font-weight: bold;
    }
    .historico {
        margin-top: 20px;
    }
    .contador {
        font-size: 14px;
        margin-bottom: 8px;
        font-weight: bold;
    }
    .msg-item {
        background: var(--verde-whatsapp);
        color: white;
        padding: 10px;
        border-radius: 10px;
        margin-bottom: 10px;
        font-size: 14px;
        word-wrap: break-word;
    }
    body.dark .msg-item {
        background: var(--verde-escuro);
    }
    .nota {
        font-size: 12px;
        font-style: italic;
        margin-top: 5px;
        opacity: 0.8;
    }
    .nome {
        font-size: 14px;
        font-weight: bold;
        margin-bottom: 5px;
    }
</style>
</head>
<body>
    <div class="container">
        <button class="tema-toggle" onclick="alternarTema()">üåô Mudar Tema</button>
        <h2>Enviar no WhatsApp</h2>
        <input type="tel" id="numero" placeholder="Ex: 11987654321" maxlength="13">
        <textarea id="mensagem" placeholder="Digite sua mensagem"></textarea>
        <button class="btn-enviar" onclick="enviarMensagem()">üì© Enviar</button>

        <div class="historico">
            <div class="contador" id="contadorContatos">Contatos no hist√≥rico: 0</div>
            <div id="historico"></div>
        </div>
    </div>

<script>
function enviarMensagem() {
    let numero = document.getElementById("numero").value.replace(/\D/g, '');
    let mensagem = document.getElementById("mensagem").value.trim();

    if (!/^\d{2}\d{9}$/.test(numero)) {
        alert("Digite um n√∫mero v√°lido no formato brasileiro: DDD + 9 d√≠gitos. Ex: 11987654321");
        return;
    }

    let numeroCompleto = "55" + numero;
    let url = `https://wa.me/${numeroCompleto}?text=${encodeURIComponent(mensagem)}`;
    window.open(url, '_blank');

    salvarHistorico(numeroCompleto, mensagem, "", "");
    mostrarHistorico();
    document.getElementById("numero").value = "";
    document.getElementById("mensagem").value = "";
}

function salvarHistorico(numero, mensagem, nota, nome) {
    let historico = JSON.parse(localStorage.getItem("historico") || "[]");
    historico.unshift({ numero, mensagem, nota, nome, data: new Date().toLocaleString() });
    localStorage.setItem("historico", JSON.stringify(historico));
}

function mostrarHistorico() {
    let historico = JSON.parse(localStorage.getItem("historico") || "[]");
    document.getElementById("contadorContatos").innerText = `Contatos no hist√≥rico: ${historico.length}`;
    let lista = document.getElementById("historico");
    lista.innerHTML = "";
    historico.forEach((item, index) => {
        lista.innerHTML += `
            <div class="msg-item">
                ${item.nome ? `<div class="nome">üë§ ${item.nome}</div>` : ""}
                <b>${item.numero}</b><br>${item.mensagem}
                ${item.nota ? `<div class="nota">üìù ${item.nota}</div>` : ""}
                <br><small>${item.data}</small><br>
                <button class="btn-nome" onclick="adicionarNome(${index})">üë§ Nome</button>
                <button class="btn-nota" onclick="adicionarNota(${index})">üìù Nota</button>
                <button class="btn-reenviar" onclick="reenviarMensagem(${index})">üîÑ Reenviar</button>
                <button class="btn-excluir" onclick="excluirRegistro(${index})">üóë Excluir</button>
            </div>
        `;
    });
}

function adicionarNome(index) {
    let historico = JSON.parse(localStorage.getItem("historico") || "[]");
    let novoNome = prompt("Adicionar/Editar nome:", historico[index].nome || "");
    if (novoNome !== null) {
        historico[index].nome = novoNome.trim();
        localStorage.setItem("historico", JSON.stringify(historico));
        mostrarHistorico();
    }
}

function adicionarNota(index) {
    let historico = JSON.parse(localStorage.getItem("historico") || "[]");
    let novaNota = prompt("Adicionar/Editar nota:", historico[index].nota || "");
    if (novaNota !== null) {
        historico[index].nota = novaNota.trim();
        localStorage.setItem("historico", JSON.stringify(historico));
        mostrarHistorico();
    }
}

function reenviarMensagem(index) {
    let historico = JSON.parse(localStorage.getItem("historico") || "[]");
    let url = `https://wa.me/${historico[index].numero}?text=${encodeURIComponent(historico[index].mensagem)}`;
    window.open(url, '_blank');
}

function excluirRegistro(index) {
    if (confirm("Tem certeza que deseja excluir este registro?")) {
        let historico = JSON.parse(localStorage.getItem("historico") || "[]");
        historico.splice(index, 1);
        localStorage.setItem("historico", JSON.stringify(historico));
        mostrarHistorico();
    }
}

function alternarTema() {
    document.body.classList.toggle("dark");
}

mostrarHistorico();
</script>
</body>
</html>
